{{ define "css-recipe/list" }}
<style>
    .compact-image {
        box-sizing: initial;
        width: 32px;
        height: 32px;
        vertical-align: middle;
        padding: 5px;
    }
</style>
{{ end }}

{{ define "content-recipe/list" }}
<section class="row">
    <div class="col s12 l12">
        <div class="section">
            {{if .SearchQuery}}
            <span class="chip left">
                Search: {{.SearchQuery}}, Results: {{.ResultCount}}
                <i class="material-icons right clickable" onclick="location.href='?clear=true';">clear_all</i>
            </span>
            {{end}}
            {{if ne $.ViewType "compact"}}
            <i class="material-icons right black-text">view_agenda</i>
            <a href="?view=compact"><i class="material-icons right grey-text">view_headline</i></a>
            {{else}}
            <a href="?view=full"><i class="material-icons right grey-text">view_agenda</i></a>
            <i class="material-icons right black-text">view_headline</i>
            {{end}}
        </div>
    </div>
    
    {{template "pagination-recipe/list" .}}
    
    {{range .Recipes}}
    {{if ne $.ViewType "compact"}}
    <div class="col s12 m6 l4">
        <article class="card small grey lighten-4 hoverable clickable" onclick="location.href = '{{RootUrlPath}}/recipes/{{.ID}}';">
            {{if .Image}}
            <section class="card-image">
                <img src="{{RootUrlPath}}{{.Image}}" class="darken-10">
            </section>
            {{end}}
            <section class="rating-container">
                <i class="material-icons whole {{if eq .AvgRating 5.0}}active{{end}}">star</i>
                <i class="material-icons half {{if eq .AvgRating 4.5}}active{{end}}">star</i>
                <i class="material-icons whole {{if eq .AvgRating 4.0}}active{{end}}">star</i>
                <i class="material-icons half {{if eq .AvgRating 3.5}}active{{end}}">star</i>
                <i class="material-icons whole {{if eq .AvgRating 3.0}}active{{end}}">star</i>
                <i class="material-icons half {{if eq .AvgRating 2.5}}active{{end}}">star</i>
                <i class="material-icons whole {{if eq .AvgRating 2.0}}active{{end}}">star</i>
                <i class="material-icons half {{if eq .AvgRating 1.5}}active{{end}}">star</i>
                <i class="material-icons whole {{if eq .AvgRating 1.0}}active{{end}}">star</i>
                <i class="material-icons half {{if eq .AvgRating 0.5}}active{{end}}">star</i>
            </section>
            <section class="card-content">
                <span class="card-title">{{.Name}}</span>
            </section>
        </article>
    </div>
    {{else}}
    <div class="col s12 m6 l3">
        <a href="{{RootUrlPath}}/recipes/{{.ID}}">
            <img {{if .Image}}src="{{RootUrlPath}}{{.Image}}"{{end}} class="compact-image circle">
            <span>{{.Name}}</span>
        </a>
    </div>
    {{end}}
    {{end}}
    
    {{template "pagination-recipe/list" .}}
    
</section>
<section class="fixed-action-btn">
    <a href="{{RootUrlPath}}/recipes/create" class="btn-floating btn-large waves-effect green">
        <i class="material-icons">add</i>
    </a>
</section>
{{ end }}

{{define "pagination-recipe/list"}}
{{$baseLink := .PerPage | printf "?q=%s&count=%d&page=" .Query}}
<ul class="pagination col s12 l12 center">
    <li class="{{if le .PageNum 1}}disabled{{end}}">
        <a href="{{if gt .PageNum 1}}{{$baseLink}}1{{else}}#{{end}}"><i class="material-icons">first_page</i></a>
    </li>
    <li class="{{if le .PageNum 1}}disabled{{end}}">
        <a href="{{if gt .PageNum 1}}{{$baseLink}}{{Add .PageNum -1}}{{else}}#{{end}}"><i class="material-icons">chevron_left</i></a>
    </li>
    {{range  Paginate .PageNum .NumPages 5}}
    <li {{if eq $.PageNum .}}class="active"{{end}}>
        <a href="{{$baseLink}}{{.}}">{{.}}</a>
    </li>
    {{end}}
    <li class="{{if ge .PageNum .NumPages}}disabled{{end}}">
        <a href="{{if lt .PageNum .NumPages}}{{$baseLink}}{{Add .PageNum 1}}{{else}}#{{end}}"><i class="material-icons">chevron_right</i></a>
    </li>
    <li class="{{if ge .PageNum .NumPages}}disabled{{end}}">
        <a href="{{if lt .PageNum .NumPages}}{{$baseLink}}{{.NumPages}}{{else}}#{{end}}"><i class="material-icons">last_page</i></a>
    </li>
</ul>
{{end}}