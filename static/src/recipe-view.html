<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="recipe-view">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <h2>[[recipe.name]]</h2>

        <iron-ajax
            auto
            id="recipeAjax"
            url="/api/v1/recipes/{{recipeId}}"
            method="GET"
            handle-as="json"
            on-request="_handleGetRecipeRequest"
            on-response="_handleGetRecipeResponse"
            on-error="_handleGetRecipeError"
            debounce-duration="0"></iron-ajax>
    </template>

    <script>
        Polymer({

            is: 'recipe-view',

            properties: {
                recipeId: {
                    type: String,
                    notify: true,
                    observer: '_recipeIdChanged'
                },
                recipe: {
                    type: Object
                }
            },

            _recipeIdChanged: function() {
            },

            attached: function() {
                var jwtToken = localStorage.getItem("jwtToken");
                this.$.recipeAjax.headers = {"Authorization": "Bearer " + jwtToken};
            },

            _handleGetRecipeRequest: function(request) {
                this.recipe = null;
            },
            _handleGetRecipeResponse: function(request) {
                this.recipe = request.detail.response;
            }

        });
    </script>
</dom-module>
